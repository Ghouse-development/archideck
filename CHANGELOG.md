# ArchiDeck 開発履歴

## 技術仕様

### アーキテクチャ
- **フロントエンド**: 単一HTMLファイル（CSS/JS埋め込み）
- **バックエンド**: Supabase（PostgreSQL + RLS + Storage + Auth）
- **ホスティング**: Vercel
- **認証**: Supabase Auth（メール/パスワード）

### データベーステーブル
| テーブル名 | 用途 |
|-----------|------|
| projects | 案件情報 |
| designers | 設計士・IC・外構担当 |
| tasks | タスクマスタ |
| project_tasks | カスタムタスク |
| project_minutes | 議事録 |
| project_handovers | 引継書 |
| products | 商品マスタ |
| vendors | 業者情報 |
| organizations | 組織（マルチテナント） |
| subscriptions | サブスクリプション |
| plans | 料金プラン |
| audit_logs | 監査ログ |

### セキュリティ
- RLS（Row Level Security）による組織単位のデータ分離
- JWT認証
- XSS対策ヘッダー（vercel.json）

### 本番URL
- メインアプリ: https://nandemo-nu.vercel.app/ （ドメイン変更予定）
- 管理者画面: https://nandemo-nu.vercel.app/admin

---

## v4.2.0 (2025-12-13)

### プレミアムUI & FC展開対応

#### UIデザイン全面刷新
- プレミアムカラーパレット（Deep Ocean Blue + Emerald Green）
- 洗練されたシャドウとトランジション効果
- グローバルスクロールバースタイリング
- アニメーションユーティリティクラス追加
- プロジェクトカードのホバーエフェクト改善

#### FC向けノーコードカスタマイズ
- 設定画面に「カスタマイズ」タブ追加
- 会社名・ロゴURL設定
- メインカラー/アクセントカラー設定（カラーピッカー）
- リアルタイムプレビュー機能
- 組織別ホワイトラベル適用

#### 議事録機能強化
- 複数ファイル保存対応
- ファイル一覧表示
- 個別削除機能
- ファイルサイズ表示

#### kintone連携
- CSVインポート機能
- CSVエクスポート機能
- フィールドマッピング設定

#### バックアップ機能
- 全データJSONエクスポート
- JSONからの復元機能
- 復元前の注意事項表示

#### 品質向上
- 案件カード初期状態：全セクション閉じた状態
- 不要ページ削除（landing.html, signup.html）
- CSSの整理・最適化

---

## v4.1.0 (2025-12-13)

### UX改善 - 販売レベルへの品質向上

#### 案件カード改善
- 5部構成の順番を変更（タスク→メモ→議事録→引継書→業務内容）
- 業務内容は初期表示で開いた状態、他は閉じた状態
- ドラッグ&ドロップで議事録ファイルをアップロード可能に

#### モバイル対応強化
- スマートフォン・タブレットでの操作性向上
- タッチ操作に最適化されたボタンサイズ
- 横スクロール可能なタブナビゲーション
- レスポンシブなフォーム入力

#### ログイン機能
- 開発中のためパスワード無しログイン機能追加
- デモモードでの動作確認が可能

#### 管理者ダッシュボード
- デモモード追加（アカウントなしで画面確認可能）
- 全ボタン・機能の動作を実装
- 組織の追加・編集・削除機能
- プランの追加・編集機能
- サブスクリプション詳細表示
- 監査ログのCSVエクスポート
- ユーザードロップダウンメニュー

#### 外構依頼
- ステータス名を簡略化（「ヒアリングシート＋3DSデータ：UP済」→「UP済」）

---

## v4.0.0 (2025-12-13)

### SaaS版マルチテナント対応 - 100社販売に向けて

#### 新規ページ
- **ランディングページ** (`landing.html`): 新規顧客向けの営業ページ
- **会社登録ページ** (`signup.html`): 3ステップのサインアップフロー
- **管理者ダッシュボード** (`admin/index.html`): スーパーアドミン用管理画面

#### マルチテナント対応
- 組織（会社）テーブル追加
- サブスクリプション管理テーブル追加
- 組織メンバー管理
- RLSポリシーによるデータ分離
- 招待トークンによるユーザー招待機能

#### 料金プラン
| プラン | 月額 | ユーザー | 案件 |
|-------|------|---------|------|
| スターター | ¥9,800 | 5名 | 100件 |
| プロフェッショナル | ¥19,800 | 15名 | 500件 |
| エンタープライズ | ¥49,800 | 50名 | 無制限 |

#### ホワイトラベル対応
- 会社ロゴのカスタマイズ
- プライマリカラー・セカンダリカラーの変更
- タイトル・ファビコンのカスタマイズ
- カスタムドメイン対応（エンタープライズプラン）

#### 管理者ダッシュボード機能
- KPIダッシュボード（総組織数、アクティブユーザー、月間売上）
- 組織管理（追加・編集・検索）
- サブスクリプション管理
- プラン設定
- 監査ログ

#### SQLマイグレーション
```sql
-- 新規テーブル
organizations          -- 組織情報
subscriptions          -- サブスクリプション
plans                  -- プランマスタ
organization_members   -- 組織メンバー
invitations            -- 招待トークン
audit_logs             -- 監査ログ
super_admins           -- スーパーアドミン
usage_stats            -- 使用量統計
```

---

## v3.0.0 (2025-12-13)

### 大規模リニューアル - ArchiDeckへリブランディング

#### システム名変更
- 旧名称: 設計・IC業務管理システム / nandemo
- 新名称: **ArchiDeck** (Gハウス 設計業務管理システム)

#### フォルダ・URL変更
- フォルダ: `sekkei` → `archideck`
- GitHub: `nandemo` → `archideck`
- Vercel: `nandemo` → `archideck`
- 本番URL: `https://archiceck.vercel.app/archideck/index.html`

#### 商品マスタ名称変更
- `LIFEリミ` → `LIFE Limited`
- `LIFE+リミ` → `LIFE+ Limited`

#### タスク定義変更

**削除したタスク:**
- 1回目打合せ、2回目打合せ、3回目打合せ
- 見積、契約、構造図書類、確認済証、図面等納品

**追加したタスク:**
1. 契約書・引継書チェック
2. 現地調査
3. 間取確定
4. 面積チェック
5. チェックリスト
6. 引継書入力
7. 外構依頼
8. 実施図依頼
9. 地盤調査

**名称変更:**
- エボルツ依頼 → evoltz依頼
- サッシプレゼン → サッシ依頼
- 確認申請 → 申請GO
- 換気図面 → 換気図依頼
- 給排水設備図面 → 給排水依頼

**ステータスオプション更新:**
- 構造依頼: ラフチェック / 構造GO / 1回目CB / 2回目CB / 変更契約前会議UP / 確定図をダンドリワークUP
- evoltz依頼: 候補図依頼 / 候補図保存済 / 確定図依頼 / 確定図保存済
- 太陽光依頼: 依頼済 / 保存済 / 営業共有済

#### 新機能

**5部構成カードUI:**
1. 業務内容（タスクチェックボックス）
2. タスク（カスタムタスク追加）
3. メモ欄（IC・外構共有）
4. 議事録（ファイルアップロード）
5. 引継書（内容保存）

**外構担当機能:**
- アカウント選択画面に外構担当追加
- スタッフ管理に外構担当カテゴリ追加
- サイドバーに外構担当セクション追加（緑色アクセント）
- 案件モーダルに外構担当フィールド追加

**サイドバー色分け表示:**
- 4件以下: 青色
- 5件以上: 黄色
- 7件以上: 名前が赤色

**申請GO条件チェック:**
以下の条件を満たさないと押せない:
- 太陽光依頼が「営業共有済」
- 給排水依頼が「保存済」
- 換気図依頼が「保存済」
- サッシ依頼が「保存済」

**担当者タスク一覧:**
- サイドバーの各担当者名横に📋ボタン
- クリックでタスク一覧モーダル表示
- 期限順/邸名順の切り替え可能

**kintone連携設定:**
- ドメイン設定
- アプリID設定
- APIトークン設定
- 接続テスト機能

**議事録アップロード:**
- Supabase Storageへのファイルアップロード
- PDF, Word, Excel対応

**共有メモ・引継書:**
- IC・外構も見られる共有メモ欄
- 引継書の入力・保存機能

#### 新規テーブル（SQL）
1. `project_tasks` - 案件タスク管理
2. `project_minutes` - 議事録管理
3. `notifications` - 通知管理
4. `project_handovers` - 引継書管理
5. `kintone_settings` - kintone連携設定

#### projectsテーブル新カラム
- `exterior_assignee` - 外構担当
- `shared_memo` - 共有メモ
- `kintone_record_id` - kintone連携用
- `layout_confirmed_date` - 間取確定日
- `construction_permit_date` - 着工許可日
- `pre_contract_meeting_date` - 変更契約前会議日

---

## v2.0.0 (2025-11)

### カスタマイズ可能システム

- 業者管理機能
- タスク-業者紐づけ
- メールテンプレート管理
- IC担当機能追加
- アーカイブ機能

---

## v1.0.0 (2025-10)

### 初期リリース

- 案件管理（CRUD）
- 16種類のタスク進捗管理
- 設計士管理
- Supabase認証
